%!TEX root = ../DDE-Project-Master.tex

\section{Proofs of preparatory Lemmas} \label{Appendix_proofs}

\bp[Proof of Proposition~\ref{prop:uniform-conv}]
It is easy to show based on \eqref{eq:Pn2} we have for \(\theta\in[-1,1]\)
\bea
    |K_n(\theta)| &\leq (n^2 + 1) |L_n(\theta)| + \sum_{j=0}^{n-1} (2j+1) |L_j(\theta)| \\
    &\leq (n^2 + 1) + \sum_{j=0}^{n-1} (2j+1) \\
    &= 2n^2 + 1,
\eea
i.e., \(\| K_n \|_\infty \leq 2n^2 + 1.\)

By the definition of \(\langle \cdot, \cdot \rangle_\mcE\) and the Koornwinder polynomials, we have that for \(n\in\Nzero\)
\bea\label{inner-product}
    \langle \psi, \mathcal K_n \rangle_\mcE &= \frac 1 2 \int_{-1}^1 f(x)K_n(x) \d x + f(1) \\
    &= \frac 1 2 \left[-\int_{-1}^1 f(x)(1+x)L_n'(x) \d x + (n^2+n+1)\int_{-1}^1 f(x)L_n(x) \d x \right] + f(1).
\eea
If we use integration by parts, we find that 
\be\label{int-by-parts}
    -\int_{-1}^1 f(x)(1+x)L_n'(x) \d x = -2f(1) + \int_{-1}^1 f'(x)(1+x)L_n(x) \d x + \int_{-1}^1 f(x)L_n(x) \d x.
\ee
Applying \eqref{int-by-parts} to \eqref{inner-product} gives that
\bea
    \langle \psi, \mathcal K_n \rangle_\mcE &= \frac 1 2 \int_{-1}^1 f'(x)(1+x)L_n(x) \d x + \frac{n^2 + n + 2} 2 \int_{-1}^1 f(x)L_n(x) \d x \\
    &= \frac 1 2 \int_{-1}^1 f'(x)(1+x)L_n(x) \d x + \frac{n^2 + n + 2} {2n + 1} a_n(f).
\eea
We can also note that by applying the Ho\"lder inequality we get
\bea
    \left| \int_{-1}^1 f'(x)(1+x)L_n(x) \d x \right| &\leq \| f' \|_\infty \left( \int_{-1}^1 (1+x) \d x \right)^{1/2} \| L_n \|_{L^2} \\
    &= \frac {4 \| f' \|_\infty } {\sqrt{6n + 3}}.
\eea
Furthermore, from \cite[Thm.~2.1]{ConvOfLegendre} we have 
\be
|a_n(f)| \leq \frac {V_1} {n - \frac 1 2} \sqrt{\frac \pi {2n}},
\ee
where \(V_1 := \int_{-1}^1 \frac {f''(x)} {\sqrt{1-x^2}} \d x < \infty\). Thus,
\be
    | \langle \psi, \mathcal K_n \rangle_\mcH | \leq \frac {2 \| f' \|_\infty} {\sqrt{6n + 3}} + V_1\sqrt{2\pi} \frac{n^2 + n + 2}{\sqrt n (4n^2 + 1)},
\ee
and so
\bea
    \frac{| \langle \psi, \mathcal K_n \rangle_\mcH |}{\| \mathcal K_n \|_\mcH^2} \| K_n \|_\infty &\leq \left[  \frac {2 \| f' \|_\infty} {\sqrt{6n + 3}} + V_1\sqrt{2\pi} \frac{n^2 + n + 2}{\sqrt n (4n^2 + 1)} \right] \times \left[ \frac{(2n + 1)(2n^2 + 1)}{(n^2 + 1)((n+1)^2 +1)} \right] \\
    &= O\left( \frac 1 {n^{3/2}} \right).
\eea
By the Weierstrass M-test, the series \eqref{koorn-series} converges uniformly. 

Note also that \eqref{koorn-series} is simply the functional part of the Koornwinder expansion of \(\psi\) in \(\mcH\). So the series converges in \(L^2([-1,1]; \mathbb R)\) to \(\psi^D = f\). Therefore, since the series converges uniformly, it must converge uniformly to \(f\).
\ep


\bp[Proof of Lemma~\ref{Lemma_S_N}]
Using \eqref{eq:Pn2}, we can show that for \(m\leq N\in\Nzero\) 
\bea
    \int_{-1}^1 S_N(x) L_m(x) \d x &= \sum_{n=0}^N \frac 1 {\| \mcK_n \|_\mcE^2} \int_{-1}^1 K_n(x)L_m(x) \d x \\
    &= \| L_m \|_{L^2([-1,1])}^2 \left[ (m^2 + 1)\frac 1 {\| \mcK_m \|_\mcE^2} - (2m + 1) \sum_{k=m+1}^N \frac 1 {\| \mcK_k \|_\mcE^2}  \right],
\eea
and so
\be\label{eq:SN-expansion}
    S_N(x) = \sum_{n=0}^N \left[ \frac{n^2 + 1}{\| \mcK_n \|_\mcE^2} - (2n+1)\sum_{m=n+1}^N \frac 1 {\| \mcK_m \|_\mcE^2} \right] L_n(x).
\ee
It is easy to show that
\bea
    \sum_{n=0}^N \frac 1 {\| \mcK_n \|_\mcE^2} &= \sum_{n=0}^N \frac{2n + 1}{(n^2 + 1)((n+1)^2 + 1)} \\
    &= \sum_{n=0}^N \left[ \frac 1 {n^2 + 1} - \frac 1{(n + 1)^2 + 1} \right] \\
    &= 1 - \frac 1 {(N+1)^2 +1}
\eea
and 
\be \label{eq:recip-sum}
    \sum_{m=n+1}^N \frac 1 {\| \mcK_m \|_\mcE^2} = \sum_{m=0}^N \frac 1 {\| \mcK_m \|_\mcE^2} - \sum_{m=0}^n \frac 1 {\| \mcK_m \|_\mcE^2} 
    = \frac 1 {(n+1)^2 + 1} - \frac 1 {(N+1)^2 + 1}.
\ee
Applying \eqref{eq:recip-sum} to \eqref{eq:SN-expansion} gives
\bea
    S_N(x) &= \sum_{n=0}^N \left[ \frac{n^2 + 1}{\| \mcK_n \|_\mcE^2} - (2n+1)\left(\frac 1 {(n+1)^2 + 1} - \frac 1 {(N+1)^2 + 1}\right) \right] L_n(x) \\
    &= \sum_{n=0}^N \left[ \frac{2n + 1}{(n+1)^2 + 1} - \frac {2n+1} {(n+1)^2 + 1} + \frac {2n+1} {(N+1)^2 + 1} \right] L_n(x) \\
    &= \sum_{n=0}^N \frac {2n + 1}{(N+1)^2 + 1} L_n(x).
\eea


It is known that 
\be
    |L_n(x)| \leq 1, \quad \forall x\in[-1,1],\ \forall n\in\Nzero.
\ee
Thus for \(x\in[-1,1]\) and \(N\in\Nzero\)
\bea
    |S_N(x)| &\leq \frac 1 {(N+1)^2 +1} \sum_{n=0}^N (2n + 1) |L_n(x)| \\
    &\leq \frac 1 {(N+1)^2 +1} \sum_{n=0}^N (2n + 1) \\
    &= \frac {N^2 +1} {(N+1)^2 +1} \\
    &< 1.  
\eea
From \cite[Thm.~61]{Rainville}, we also have that for \(n\geq 1\) and \(x\in(-1, 1)\)
\be
    |L_n(x)| < \sqrt{\frac \pi {2n(1-x^2)}}.
\ee
Then for \(x\in(-1,1)\) and \(N\in\Nzero\)
\bea
    |S_N(x)| &\leq \frac 1 {(N+1)^2 +1} \left[ 1 + \sum_{n=1}^N (2n+1)|L_n(x)| \right] \\
    &\leq \frac 1 {(N+1)^2 +1} \left[ 1 + 3 \sum_{n=1}^N n  \cdot \sqrt{\frac \pi {2n(1-x^2)}}\right] \\
    &=  \frac 1 {(N+1)^2 +1} \left[ 1 + 3\cdot\sqrt{\frac \pi {2(1-x^2)}} \cdot \sum_{n=1}^N \sqrt n \right].
\eea
We can note that 
\be
    \sum_{n=1}^N \sqrt n \leq \int_1^{N+1} \sqrt x \d x = \frac 2 3(N+1)^{3/2} - \frac 2 3.
\ee
So 
\be
     |S_N(x)| \leq \frac 1 {(N+1)^2 +1} \left[ 1 + \sqrt{\frac {2\pi} {1-x^2}} \left((N + 1)^{3/2} - 1\right)  \right],
\ee
where the right-hand side converges to \(0\) as \(N\to\infty\) for fixed \(x\in(-1,1).\) Thus \(S_N(x) \to 0\) as \(N\to\infty\) for \(x\in(-1,1)\).
\ep


